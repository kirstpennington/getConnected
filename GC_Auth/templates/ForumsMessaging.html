<!DOCTYPE html>
<html lang="en">

<head>

    <!--*HEAD* Firebase-->

    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyCW2DTUu_qEhCG9xpj5gGkG2_QC_CmsGQE",
            authDomain: "getconnected-9dac0.firebaseapp.com",
            databaseURL: "https://getconnected-9dac0.firebaseio.com",
            projectId: "getconnected-9dac0",
            storageBucket: "getconnected-9dac0.appspot.com",
            messagingSenderId: "144309081376"
        };
        firebase.initializeApp(config);
    </script>

    <!--*HEAD* 1. Title-->

    <title>Forum</title>

    <!--*HEAD* 2. Bootstrap & CSS Links-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../GC_Auth/GC_Auth/static/GC_Auth/loginstyle.css">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script>import TimeAgo from 'javascript-time-ago'</script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- footer style -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Navigation Bar Style + Body Style -->

    <style>
        /*dropdown menu on navbar*/
        .dropdown {
            display: inline-block;
            margin-left: 20px;
        }

        /* specify the font for the page*/
        body {
            font-family: 'Roboto', sans-serif;


        }

        /*icon for bell*/
        .glyphicon-bell {
            font-size: 1.5rem;
        }

        .notifications {
            min-width: 320px;
        }

        .notifications-wrapper {


            max-height: 250px;
        }

        /*icon*/
        .glyphicon-circle-arrow-right {
            margin-left: 10px;
        }

        .item-title {
            font-size: 1.5rem;
            color: black;
            padding: 0px 50px;
        }

        .notifications a.content {
            text-decoration: none;
            background: white;
        }


        /*icon for user profile img*/
        .profile_img {
            width: 50px;
            display: inline;
            float: left;
            border: 0px solid #111;
            border-radius: 25px;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.5) inset;
            margin-right: -20px;
        }


        /*save changes button hover effects*/
        button:hover {
            -ms-transform: scale(1); /* IE 9 */
            -webkit-transform: scale(1); /* Safari 3-8 */
            transform: scale(1);
            border: 1px solid silver;
            box-shadow: 3px 3px 3px #888888;
        }

        /*save changes button effects*/
        button {

            border-radius: 8px;
            color: #666666;
            background-color: white;
            border: 2px solid grey; /*#e83e8c*/
            display: inline-block;
            padding-top: 3px;
            padding-bottom: 3px;
            padding-left: 10px;
            padding-right: 10px;
            font-size: 12px;

        }

        button:focus {
            outline: none;
        }

        .closer button {
            position: absolute;
            right: 7%;
            top: 25%;
            font-size: 10px;

        }

        /*save changes button hover effects*/
        .closer button:hover {


        }

    </style>

    <!-- background Page format styles-->

    <style>


        .profileContainerDetails .UserWallpaper {
            height: 380px;
            background-position: center;
        }

        .UserWallpaper {
            height: 100vh;
            background-size: cover;
            margin: 0;
            padding: 0;
            border: 0;
            display: flex;
            align-items: center;

        }

        .parallax {
            /* The image used */

            /* Set a specific height */

            /* Create the parallax scrolling effect */
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }


        .profileContainerLift {
            margin: -280px 30px 0; /* Up and down control */
            border-radius: 8px;
            box-shadow: 0 16px 24px 2px rgba(0, 0, 0, .14), 0 6px 30px 5px rgba(0, 0, 0, .12), 0 8px 10px -5px rgba(0, 0, 0, .2);
            height: auto; /* For Mandy to adjust size of pafe */
            margin-bottom: 30px;
        }

        .profileContainer { /* Container Control */
            background: #FFF;
            position: relative;
            z-index: 3;
        }

        .profileContainerDetails .profile img {
            max-width: 160px;
            width: 100%;
            margin: 0 auto;
            -webkit-transform: translate3d(0, -50%, 0);
            -moz-transform: translate3d(0, -50%, 0);
            -o-transform: translate3d(0, -50%, 0);
            -ms-transform: translate3d(0, -50%, 0);
            transform: translate3d(0, -50%, 0);
        }

        .img-raised { /* Profile Picture 1/3 */
            box-shadow: 0 5px 15px -8px rgba(0, 0, 0, .24), 0 8px 10px -5px rgba(0, 0, 0, .2);

        }

        .avatar:hover .changeImageLabel {
            opacity: 0.9;
            display: inline-block;
        }

        .rounded-circle { /* Profile Picture 2/3 */
            border-radius: 50% !important;
        }

        .img-fluid { /* Profile Picture 3/3 */
            max-width: 100%;
            max-height: 160px;
        }

        .profileContainerDetails .description {
            margin: 1.071rem auto 0;
            max-width: 600px;
            color: #999;
            font-weight: 300;
        }

        .profileContainerDetails, html {
            max-width: 100%;

        }

        .profileContainerDetails .gallery img {
            width: 100%;
            margin-bottom: 2.142rem;
        }

        .profileContainerDetails .profile .name {
            margin-top: -80px;
        }


    </style>

    <!-- Cards Style-->

    <style>


        /*footer logo*/
        footer img {


            width: 200%;
            height: 200%;
            text-align: left;

        }


        .well a:hover {
            text-decoration: none;

        }

    </style>


    <!--User profile page-->
    <style>


        .image-section img {
            width: 100%;
            height: 250px;
            position: relative;
        }


        .user-image img {
            width: 100px;
            height: 100px;
        }


        .user-detail-section2 span {
            color: #7CBBC3;
            font-size: 20px;
        }

        .user-detail-section2 small {
            font-size: 12px;
            color: #D3A86A;
        }


        .profile-header-section1 h1 {
            font-size: 25px;
            margin: 0px;
        }

        .profile-header-section1 h5 {
            color: #0062cc;
        }


        .profile-tag i {
            color: #ADADAD;
            font-size: 20px;
        }


        .image-right-detail a:hover {
            text-decoration: none;
        }

        .image-right img {
            width: 100%;
        }


        .image-right-detail-section2 span {
            color: #7F7F7F;
        }

        .well a:hover {
            text-decoration: none;

        }

    </style>

    <!--forum content styles-->
    <style>

        .forumcontent body {
            background-color: #eeeeee;
        }

        .forumcontent .h7 {
            font-size: 0.8rem;
        }

        .forumcontent .gedf-wrapper {
            margin-top: 0.97rem;
        }

        @media (min-width: 992px) {
            .forumcontent .gedf-main {
                padding-left: 4rem;
                padding-right: 4rem;
            }

            .forumcontent .gedf-card {
                margin-bottom: 2.77rem;
            }
        }

        /**Reset Bootstrap*/
        .forumcontent .dropdown-toggle::after {
            content: none;
            display: none;
        }

        /*style for each message posted*/
        .messagePost {
            border: solid lightgrey 1px;
            border-radius: 10px;
            padding-left: 4px;
            padding-right: 2px;
            padding-top: 4px;
            box-shadow: 0 2px 2px 0;

        }

        /*makes the item stay*/
        .sticky {
            position: -webkit-sticky;
            position: sticky;
            top: 0;
        }

        /* View replies*/
        details summary::-webkit-details-marker {
            color: #e83e8c;
            outline: none;

        }


        ::placeholder {
            font-style: italic;
            font-family: Arial;
        }

    </style>

</head>

<body class="profileContainerDetails">
<!--*BODY* 1. Navigation Bar-->
<!--dialog pop-ups-->
<dialog class="text-center" id="connectedWith"
        style="box-shadow: 2px 2px 2px 2px grey;color: white;position: absolute; top: 30%;z-index: 4;border: 1px solid white;font-family: 'Roboto', sans-serif;border-radius: 8px;background-color: darkgray;width: 400px; height:100px;">
    <div id="newconnectionmodal"></div>
    <br>
    <button id="close" style="border: 1px solid #e83e8c;border-radius: 8px;
        color: #e83e8c; background-color:white; font-family: 'Roboto', sans-serif;position: center; ">Okay
    </button>
</dialog>


<dialog class="text-center" id="forumJoined"
        style="box-shadow: 2px 2px 2px 2px grey;;color: white;position: absolute; top:30%;z-index: 4;border: 1px solid white;font-family: 'Roboto', sans-serif;border-radius: 8px;background-color: darkgray;width: 400px; height:100px;">
    <p>You have joined a new forum!</p>
    <br>
    <button id="shut" style="border: 1px solid #e83e8c;border-radius: 8px;
        color: #e83e8c; background-color:white; font-family: 'Roboto', sans-serif;position: center; ">Okay
    </button>
</dialog>

<script>


    var x = document.getElementById("forumJoined");
    var y = document.getElementById("connectedWith");

    document.querySelector('#close').onclick = function () {
        y.close();
    };
    document.querySelector('#shut').onclick = function () {
        x.close();
    };
</script>

<nav class="navbar navbar-inverse">
    <div class="container-fluid">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>  <!--navbar-header-->

        <div class="collapse navbar-collapse" id="myNavbar"> <!--Navigation bar contents-->

            <!--Left-side (including search ) of navigation bar-->
            <ul class="nav navbar-nav navbar-left">
                <li><a onclick="location.href='{% url 'nav_home' %}'"><span
                        class="glyphicon glyphicon-home fa-lg"></span> Home</a></li>
                <li><a onclick="location.href='{% url 'nav_networks' %}'"><span class="fa fa-globe fa-lg"></span>
                    Connections</a></li>
                <li><a onclick="location.href='{% url 'nav_forums' %}'"
                       style="color:white;border-left: 1px solid white;border-right: 1px solid white;"><span
                        class="fa fa-comments-o fa-lg"></span> Forums</a></li>
                <li><a onclick="location.href='{% url 'nav_courses' %}'"><span class="fa fa-book fa-lg"></span> Courses</a>
                </li>
            </ul>


            <!--RHS of the navigation bar -->

            <ul class="nav navbar-nav navbar-right">

                <!--MESSAGE NOTIFICATIONS -->
                <li class="dropdown"><a id="idMessage" data-toggle="dropdown" data-target="#" href="#"
                                        onclick="CloseIntroForm(); OpenLogIn();">

                    <div style=""
                         id="Messages_icons_notifications">
                        &nbsp;<span class="glyphicon glyphicon-envelope"></span>&nbsp;
                        <span id="number_of_msg_notifications" class="label label-default"
                              style="background-color: red;color: white">0</span>&nbsp;
                    </div>


                    <ul class="dropdown-menu notifications" role="menu" aria-labelledby="dLabel">

                        <div class="notifications-wrapper" style="overflow-x: hidden; "> <!--Messages Dropdown div-->

                            <ul id="Message_dropdown_notifications" style="">

                                <a class="text-center"
                                   style="font-family: sans-serif;font-style: italic;color: black; margin-left: 25%;">No
                                    Messages</a>

                                {% comment %}     <a><div style="" class="notification-item">
                                <img class="profile_img" src="{{ ProfilePic }}"/>
                                    <p style="font-family:sans-serif;font-style:italic;margin-left: 240px; color: grey">14:50</p>
                                    <h5 style="font-family: sans-serif; font-weight: bold; color: black; margin-top: -15px; left: 25px; position:relative">Winfreda Mazvidza</h5>
                                    <p style="font-family: sans-serif; color: black; margin-top: 3px;left: 30px;position:relative; font-size:small"> Hi Winny</p>
                                    <hr style="width: 100%; color: grey; height: 2px; background-color:grey; margin-top: 5px"/>
                                </div>
                            </a>

                            <a><div style="margin-top: -20px" class="notification-item">
                                <img class="profile_img" src="{{ ProfilePic }}"/>
                                    <p style="font-family:sans-serif;font-style:italic;margin-left: 240px; color: grey">14:50</p>
                                    <h5 style="font-family: sans-serif; font-weight: bold; color: black; margin-top: -15px; left: 25px; position:relative">Winfreda Mazvidza</h5>
                                    <p style="font-family: sans-serif; color: black; margin-top: 3px;left: 30px;position:relative; font-size:small"> Hi Winny</p>
                                    <hr style="width: 100%; color: grey; height: 2px; background-color:grey; margin-top: 5px"/>
                                </div>
                            </a>{% endcomment %}

                            </ul>

                        </div><!--notifications-wrapper-->
                        <li class="divider"></li>
                        <li style="font-weight: bold; font-family: sans-serif; text-align: right"
                            onclick="removeMessageNotifications() ;location.href='{% url 'nav_DirectMessaging' %}' ">
                            View All <i class="fa fa-angle-double-right"></i></li>
                    </ul><!--Dropdown menu Messages--> </a>
                </li><!--dropdown -->

                {% comment %}<!--REQUESTS NOTIFICATIONS -->
                <li style="text-decoration: none" class="dropdown"><a id="idLabel" data-toggle="dropdown"
                                                                      data-target="#" href="#"
                                                                      onclick="CloseIntroForm(); OpenLogIn();">

                    <div id="">
                        <span ><span class="glyphicon glyphicon-bell"></span>&nbsp;<span id="counter_number_notifications" class="label label-default"   style="background-color: red;color: white;font-family: Roboto, sans-serif"></span></span>

                    </div>

                    <ul style="text-decoration: none" class="dropdown-menu notifications" role="menu"
                        aria-labelledby="dLabel">

                        <div class="notifications-wrapper" style="overflow-x: hidden;text-decoration: none">
                            <!--Notifications Dropdown div-->
                            <ul id="comment_1"><p style="font-family: sans-serif;font-style: italic;color: black">No
                                Notifications</p></ul>
                        </div><!--End of Notifications Dropdown div-->

                        <!--Footer of notification drop down-->
                        <li class="divider"></li>
                        <li style="text-align: center"><a href="#"></a></li>

                    </ul> <!--Dropdown menu Notification-->
                </a>
                </li><!--dropdown -->{% endcomment %}

                <!--Profile Drop-Down -->
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown"
                                        onclick="CloseIntroForm(); OpenLogIn();">

                    <span onclick="location.href='{% url 'userprofile' %}'"> <img class="rounded-circle" width="20"
                                                                                  height="20" src="{{ profilePic }}"
                                                                                  alt=""></span>

                    <span class="glyphicon glyphicon-triangle-bottom"></span></a>

                    <ul class="dropdown-menu">
                        <li><a onclick="location.href='{% url 'settings' %}'">Settings <span
                                class="glyphicon glyphicon-cog pull-right"></span></a></li>
                        <li class="divider"></li>
                        <li><a onclick="location.href='{% url 'nav_forums' %}'">Forums <span
                                class="fa fa-comments-o pull-right"></span></a></li>
                        <li class="divider"></li>

                        <li><a onclick="location.href='{% url 'helpUserProfile' %}'">Help<span
                                class="glyphicon glyphicon-question-sign pull-right"></span></a></li>
                        <li class="divider"></li>
                        <li><a onclick="location.href='{% url 'log' %}'">Sign Out <span
                                class="glyphicon glyphicon-log-out pull-right"></span></a></li>
                    </ul>
                </li>


            </ul><!--nav navbar-nav navbar-right-->


            <script>

                /*Time for Posts Displayed*/
                const MONTH_NAMES = [
                    'January', 'February', 'March', 'April', 'May', 'June',
                    'July', 'August', 'September', 'October', 'November', 'December'
                ];

                function getFormattedDate(date, prefomattedDate = false, hideYear = false) {
                    const day = date.getDate();
                    const month = MONTH_NAMES[date.getMonth()];
                    const year = date.getFullYear();
                    const hours = date.getHours();
                    let minutes = date.getMinutes();

                    if (minutes < 10) {
                        // Adding leading zero to minutes
                        minutes = `0${minutes}`;
                    }

                    if (prefomattedDate) {
                        // Today at 10:20
                        // Yesterday at 10:20
                        return `${prefomattedDate} at ${hours}:${minutes}`;
                    }

                    if (hideYear) {
                        // 10. January at 10:20
                        return `${day}. ${month} at ${hours}:${minutes}`;
                    }

                    // 10. January 2017. at 10:20
                    return `${day}. ${month} ${year}. at ${hours}:${minutes}`;
                }

                // --- Main function
                function timeAgo(dateParam) {

                    if (!dateParam) {
                        return null;
                    }

                    const date = typeof dateParam === 'object' ? dateParam : new Date(dateParam);
                    const DAY_IN_MS = 86400000; // 24 * 60 * 60 * 1000
                    const today = new Date();
                    const yesterday = new Date(today - DAY_IN_MS);
                    const seconds = Math.round((today - date) / 1000);
                    const minutes = Math.round(seconds / 60);
                    const isToday = today.toDateString() === date.toDateString();
                    const isYesterday = yesterday.toDateString() === date.toDateString();
                    const isThisYear = today.getFullYear() === date.getFullYear();


                    if (seconds < 5) {
                        return 'now';
                    } else if (seconds < 60) {
                        return `${seconds} seconds ago`;
                    } else if (seconds < 90) {
                        return 'about a minute ago';
                    } else if (minutes < 60) {
                        return `${minutes} minutes ago`;
                    } else if (isToday) {
                        return getFormattedDate(date, 'Today'); // Today at 10:20
                    } else if (isYesterday) {
                        return getFormattedDate(date, 'Yesterday'); // Yesterday at 10:20
                    } else if (isThisYear) {
                        return getFormattedDate(date, false, true); // 10. January at 10:20
                    }

                    return getFormattedDate(date); // 10. January 2017. at 10:20
                };


                /*Message_Notificationas*/

                var Message_Notifications_Check = firebase.database().ref().child("Users/{{this_uid}}/Messages_Notifications");/*current user's account*/
                Message_Notifications_Check.on('value', function (snapshot) {
                    msg_messages_dropdown(snapshot.val());
                    msg_message_number(snapshot.val());
                });

                function msg_messages_dropdown(obj) {


                    var dropdown_item = '';
                    var keys = Object.keys(obj);
                    var counter_check = 0;


                    for (var i = keys.length - 1; i >= 0; i--) {

                        if (obj[keys[i]].ProfilePic != undefined) {

                            var display_time = obj[keys[i]].Time;
                            display_time = Number(display_time); // cast it to a Number
                            var ts_display = timeAgo(display_time);


                            if (counter_check == 0) {
                                counter_check++;

                                dropdown_item += " <a><div style= \"padding: 2px;\n" +
                                    "            margin: 5px;\n" +
                                    "            border-radius: 4px;\n" +
                                    "            border-width: 5px;\n" +
                                    "            border-color: black;\n" +
                                    "            height: 80px;\n" +
                                    "             margin-left: -20px;\n" +
                                    "            margin-top: 20px  \" class=\"notification-item\">\n" +
                                    "                                <img style=\"margin-top:-12px\" class=\"profile_img\" src=\"" + obj[keys[i]].ProfilePic + "\"/>\n" +
                                    "                                    \n" +
                                    "                                    <h5 style=\"font-family: sans-serif; font-weight: bold; color: black; margin-top: -15px; left: 55px; position:relative\">" + obj[keys[i]].Sender_name + "</h5>\n" +
                                    "                                    <p style=\"font-family: sans-serif; color: black; margin-top: 3px;left: 28px;position:relative; \"> " + obj[keys[i]].text + "</p>\n" +
                                    "                                    <p style=\"font-family:sans-serif;font-style:italic;margin-left: 58px;margin-top:2px; color: grey;font-size:x-small\"><i class= \"fa fa-clock-o \"></i>&nbsp" + ts_display + "</p>\n" +
                                    "                                    <hr style=\"width: 100%; color: grey; height: 2px; background-color:grey; margin-top: 5px\"/>\n" +
                                    "                                </div>\n" +
                                    "                            </a>";

                            } else {

                                dropdown_item += " <a><div style= \"padding: 5px;\n" +
                                    "            margin: 5px;\n" +
                                    "            border-radius: 4px;\n" +
                                    "            border-width: 5px;\n" +
                                    "            border-color: black;\n" +
                                    "            height: 80px;\n" +
                                    "             margin-left: -20px;\n" +
                                    "            margin-top: 20px \" class=\"notification-item\">\n" +
                                    "                                <img style=\"margin-top:-12px\" class=\"profile_img\" src=\"" + obj[keys[i]].ProfilePic + "\"/>\n" +
                                    "                                    \n" +
                                    "                                    <h5 style=\"font-family: sans-serif; font-weight: bold; color: black; margin-top: -15px; left: 55px; position:relative\">" + obj[keys[i]].Sender_name + "</h5>\n" +
                                    "                                    <p style=\"font-family: sans-serif; color: black; margin-top: 3px;left: 28px;position:relative; \">" + obj[keys[i]].text + "</p>\n" +
                                    "                                    <p style=\"font-family:sans-serif;font-style:italic;margin-left: 58px;margin-top:2px; color: grey;font-size:x-small\"><i class= \"fa fa-clock-o \"></i>&nbsp" + ts_display + "</p>\n" +
                                    "                                    <hr style=\"width: 100%; color: grey; height: 2px; background-color:grey; margin-top: 5px\"/>\n" +
                                    "                                </div>\n" +
                                    "                            </a>";
                            }

                        }
                    }
                    $('#Message_dropdown_notifications').html(dropdown_item);
                }


                function msg_message_number(obj) {
                    // var html = '';
                    var countholder = 0;
                    var keys = Object.keys(obj);

                    for (var i = 0; i < keys.length; i++) {
                        countholder++;
                    }
                    {% comment %}
                                    countholder--;
                    {% endcomment %}

                    {% comment %}database_counter.update({'counter': countholder});
                     /*Creating notification icon*/{% endcomment %}


                    {% comment %}
                                    html += "<span class=\"glyphicon glyphicon-bell\"></span>&nbsp;<span class=\"label label-default\" style=\"background-color: red;color: white\">" + countholder + "</span></a>";
                    {% endcomment %}


                    $('#number_of_msg_notifications').html(countholder);


                }

                function removeMessageNotifications() {

                    var other = firebase.database().ref().child("Users/" + '{{ this_uid }}');/*Messages*/
                    other.child("Messages_Notifications").remove();

                }


                /*Request Notifications*/

                var database_counter_1 = firebase.database().ref().child("Users/{{this_uid}}/RequestsReceived");/*current user's account*/


                database_counter_1.on('value', function (snapshot) {


                    renderCount_1(snapshot.val());
                   // window.alert("ggg");
                    renderUI_1(snapshot.val());
                    //alert("Connection Request Received");


                });


                function renderUI_1(obj) {
                    var html = '';
                    var keys = Object.keys(obj);
                    for (var i = keys.length - 1; i >= 0; i--) {
                        // for (var i = 0; i <= keys.length - 1; i++) {


                        /* html += "<li><b><i>" + obj[keys[i]].time + "</i></b> girl " + obj[keys[i]].receiver + "</li>";*/
                        /*Creating notification item*/

                        if (obj[keys[i]].sender_profilePic != undefined) {

                            var display_time = obj[keys[i]].time;
                            display_time = Number(display_time); // cast it to a Number
                            var ts_display = timeAgo(display_time);

                            var type_post = obj[keys[i]].Type;
                            var forum_id_id = obj[keys[i]].Forum_ID;


                            var decision = "true";
                            var opp_decison = "false";
                            html += "<div href=\"#\" class=\"content\" style=\"padding:5px;margin: 5px; border-radius: 4px; border-width: 5px; border-color: black; height: 80px; margin-left: -20px; margin-top: 40px;\"> <div style=\"padding:2px;margin:5px;border-radius:4px;border-width:5px;border-color:black;height:80px;margin-left: -10px\"><img  class=\"profile_img_1\" src=\" " + obj[keys[i]].sender_profilePic + "\"/> <p style=\"margin-left: 155px;font-size: 60%; color: darkgray;text-decoration: none\">" + "" + "&nbsp;&nbsp;</p> <h5 style=\"font-family: sans-serif; font-weight: bold; color: black; margin-top: 0px; top: -20px;left: 25px; position:relative\">" + obj[keys[i]].sender + "</h5> <p style=\"font-family: sans-serif; color: black; margin-top: -25px;left: 28px;position:relative; \">" + obj[keys[i]].message +
                                "</p> <p style=\"font-family:sans-serif;font-style:italic;margin-left: 55px;margin-top:5px; color: grey;font-size: x-small\"><i class= \"fa fa-clock-o \"></i> " + ts_display + "</p>  <div style=\"margin-top: 10px\"> <button  id=\"dntrigger\" onclick=\"Accept_request(" + "\'" + obj[keys[i]].sender_id + "\'" + "," + "\'" + obj[keys[i]].sender + "\'" + "," + "\'" + obj[keys[i]].post_id + "\'" + "," + "\'" + decision + "\'" + ",\'" + type_post + "\',\'" + forum_id_id + "\' )\" class=\"AcceptDeclinebutton\" style=\" font-size: 85%; position: relative;left: 80px;color: white\">Accept</button> <button id=\"DeclineRemove\" onclick=\"Accept_request(" + "\'" + obj[keys[i]].sender_id + "\'" + "," + "\'" + obj[keys[i]].sender + "\'" + "," + "\'" + obj[keys[i]].post_id + "\'" + "," + opp_decison + ")\" class=\"AcceptDeclinebutton\" style=\"; font-size: 85%;position: relative;left: 80px;color: white \">Decline </button> </div> <hr style=\"width: 100%; color: gray; height: 2px; background-color:grey; margin-top: 5px\"/> </div> </div><br>";


                        }
                    }
                    if (html.length == 0) {
                        html = "<div style = \"font-family: sans-serif;font-style: italic;color: black\"  > No Notifications</div>";
                    }

                    $('#comment').html(html);
                }

                function renderCount_1(obj) {
                    var html = '';
                    var countholder = 0;

                    var keys = Object.keys(obj);
                    for (var i = 0; i < keys.length; i++) {
                        countholder++;
                    }
                    countholder--;
                    database_counter.update({'counter': countholder});
                    /*Creating notification icon*/


                    html += "<span class=\"glyphicon glyphicon-bell\"></span>&nbsp;<span class=\"label label-default\" style=\"background-color: red;color: white\">" + countholder + "</span></a>";


                    $('#counter_number_notifications').html(countholder);


                }

                function Accept_request(sender_id, name, post_id, isAccept, typepost, forum_id_id) {


                    if (String(isAccept).valueOf() == String("true").valueOf()) {

                        /*Check Type of Request*/

                        firebase.database().ref("Users/" + '{{this_uid}}' + "/RequestsReceived/" + post_id + "/Type_check").once("value", snapshot => {

                            if (snapshot.exists()) {


                                if (String(typepost).valueOf() == String("Forum_Request").valueOf()) {

                                    var AddtoForum = firebase.database().ref().child("Forums/" + forum_id_id + "/Participants");/*Messages*/
                                    AddtoForum.child(sender_id).set(sender_id);

                                    var AddtoForum_Joined = firebase.database().ref().child("Users/" + sender_id + "/ForumsJoined");/*Messages*/
                                    AddtoForum_Joined.child(forum_id_id).set(forum_id_id);

                                } else {


                                    var AddtoForum = firebase.database().ref().child("Forums/" + sender_id + "/Participants");/*Messages*/

                                    AddtoForum.child('{{this_uid}}').set('{{ this_uid }}');


                                    var AddtoForum_Joined = firebase.database().ref().child("Users/" + '{{this_uid}}' + "/ForumsJoined");/*Messages*/

                                    AddtoForum_Joined.child(sender_id).set(sender_id);


                                    // window.alert("You have joined a new forum!");
                                    var x = document.getElementById("forumJoined");
                                    x.show();
                                }


                            }/*Forum Requests*/

                            else {


                                var AddConnection = firebase.database().ref().child("Users/" + '{{this_uid}}' + "/Connections");/*Messages*/
                                var AddConnection_other = firebase.database().ref().child("Users/" + sender_id + "/Connections");/*Messages*/


                                //AddConnection.child(sender_id).set(name);
                                var bio;
                                var propic;
                                var country;
                                var html = '';
                                var getAcceptcon = firebase.database().ref().child("Users/" + sender_id);
                                getAcceptcon.on("value", function (snapshot) {
                                    bio = snapshot.val().Bio;
                                    propic = snapshot.val().ProfilePic;
                                    country = snapshot.val().Country;
                                });

                                //var created_id_target = AddConnection.push();
                                AddConnection.child(sender_id).set({ /*Pushes to receiver*/
                                    Name: name,
                                    Bio: bio,
                                    ProfilePic: propic,
                                    Country: country,

                                });

                                AddConnection_other.child('{{this_uid}}').set({ /*Pushes to receiver*/
                                    Name: '{{ username }}',
                                    Bio: '{{ bio }}',
                                    ProfilePic: '{{ profilePic }}',
                                    Country: '{{ country }}',

                                });


                                // window.alert("You are now connected with " + name);

                                html += "You are now connected with " + name;
                                $('#newconnectionmodal').html(html);

                                var y = document.getElementById("connectedWith");
                                y.show();

                            }/*Friend Reuest*/
                        }); /*Checking Type of Request*/
                    } /*If Accept*/


                    firebase.database().ref("Users/" + '{{this_uid}}' + "/RequestsReceived/" + post_id + "/Type_check").once("value", snapshot => {

                        if (snapshot.exists()) {

                            var different_name = firebase.database().ref().child("Users/" + '{{this_uid}}' + "/RequestsReceived/" + post_id);/*Messages*/
                            different_name.remove();


                        } else {

                            var different_name = firebase.database().ref().child("Users/" + '{{this_uid}}' + "/RequestsReceived/" + post_id);/*Messages*/
                            different_name.remove();

                            var removesent = firebase.database().ref().child("Users/" + post_id + "/RequestsSent/" + '{{this_uid}}');/*Messages*/
                            removesent.remove();


                        }

                    });


                }


            </script>


        </div><!--collapse nav-bar collapse-->
    </div><!--container fluid-->
</nav><!--nav navbar-inverse-->


<!--used to encapsulate all content items of settings page, excl footer-->
<!--background wallpaper-->
<div class="UserWallpaper parallax" style="background-image:url(
        {% load staticfiles %}{% static "GC_Auth/UserProfile_images/campus.jpg" %}); margin-top: -20px;"></div>
<div class="profileContainer profileContainerLift"><!--1. Container for page content -->

    <div class="forumcontent">

        <br>

        <div class="container-fluid gedf-wrapper">
            <div class="row">


            </div>
            <!--information of the logged in user on LHS-->
            <div class="col-md-3">
                <div class="sticky">
                    <div class="card">
                        <!--LHS item-->
                        <div class="card-body" style="padding-left: 10px;">
                            <h5 class="card-title" style="color: #e83e8c;"><strong>Your Forums</strong></h5>
                            <br>
                            <!--styling allows for the image and text to be next to one another-->
                            {% for forum_names, forum_pics, forum_num_participants, forum_creators, forum_topics, forum_descriptions, forum_ids in my_forums_list %}

                                <form action="/goForumsOpen/" method="post">
                                    {% csrf_token %}
                                    <input class="forum_id" id="forum_id" name="forum_id" value="{{ forum_ids }}" hidden
                                           style="display: none;">
                                    <img class="rounded-circle" width="55px" height="50px" src="{{ forum_pics }}"
                                         alt="">

                                    <button onclick="location.href='{% url 'forumsopen' %}'"
                                            style="border: none; background: white;font-size: smaller; color: gray; font-weight: bold; position: relative; top: -10px"
                                            type="submit"
                                            onclick="location.href='{% url 'forumsopen' %}'">{{ forum_names }}
                                        <i
                                                class="fa fa-angle-double-right"></i></button>
                                    <div hidden id="forum_id">{{ forum_ids }}</div>
                                </form>
                                <br><br>
                            {% endfor %}

                            <a onclick="location.href='{% url 'nav_forums' %}'" class="text-right"
                               style="position: absolute; left: 50%;"> View All</a>
                            <br>

                        </div>

                    </div>
                </div>
            </div>


            <!--middle item-->
            <div class="col-md-6 gedf-main">
                {% if forum_creator != this_uid %}
                    <div class="dropdownmenu"
                         style="display: inline-block;position: relative; left: 94%; top: 10% ; color: #666666; ">
                        <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">


                            <!--more options menu-->
                            <span class="glyphicon glyphicon-option-vertical"
                                  style="color: lightgrey;"></span></a>

                            <ul class="dropdown-menu">


                                <li><a id="btn-confirm">Leave Forum <span
                                        class="glyphicon glyphicon glyphicon-remove-circle pull-right"></span></a>
                                </li>
                                <li class="divider"></li>

                                <li><a id="reportForumBtn">Report Forum<span
                                        class="    glyphicon glyphicon-warning-sign pull-right"></span></a>
                                </li>


                            </ul>
                        </li>
                    </div> <!--end of dropdown-->
                {% endif %}






                <!--FORUM MESSAGING HEADERS-->
                <!--User's Details-->

                <div style="background-color: white" class="panel-heading">
                    <div class="row"><!--table for person info-->
                        <div class="col-sm-1">
                            <div class="mr-2">
                                <!--styling allows for the image and text to be next to one another-->
                                <img class="rounded-circle" width="45" src="{{ profilePic }}" alt="">

                            </div>


                        </div>
                        <div class="col-sm-11">
                            <div class="ml-2">
                                <div class="h5 m-0" style="text-align: left;"><strong> {{ username }}</strong></div>

                                <!--Number of Connections and Forums-->
                                <script>
                                    //  count the number of forums and connections in db
                                    var numForumsRef = firebase.database().ref("Users").child("{{ this_uid }}").child("ForumsJoined");
                                    numForumsRef.on("value", function (numForums_snapshot) {
                                        document.getElementById("numForumsSpan").innerText = numForums_snapshot.numChildren();
                                        var numConnRef = firebase.database().ref("Users").child("{{ this_uid }}").child("Connections");
                                        numConnRef.on("value", function (numConnections_snapshot) {
                                            document.getElementById("numConnectionsSpan").innerText = numConnections_snapshot.numChildren();
                                        });
                                    });
                                </script>
                                <h8 style="display: inline-block;padding-right:10px; position: relative; top: -14px;padding-top: 2px;color: black;">
                                    Connections <span id="numConnectionsSpan" class="label label-default"></span></h8>
                                <h8 style="display: inline-block;padding-right:50px; position: relative; top: -14px; color: black;">
                                    Forums <span id="numForumsSpan"
                                                 class="label label-default"></span></h8>


                            </div>
                        </div>
                    </div>
                    <!-- End of User's Details-->


                    <!-- leave forum button-->

                    {% if forum_creator != this_uid %}

                    {% else %} <!-- only the forum creator can access forum settings -->
                        <form action="/goForumSettings/" method="post">
                            {% csrf_token %}
                            <input type="hidden" hidden id="this_forum_id" name="forum_id" value="{{ forum_id }}">
                            <div>
                                <button onclick="location.href='{% url 'goForumSettings' %}'" data-toggle="tooltip"
                                        title="ForumSettings" data-placement="right"
                                        style="margin-right:10px; background-color:#e83e8c; border-color: transparent;   border-radius: 10px; box-shadow: 0 0 3px rgba(0, 0, 0, 0.1) inset "
                                        type="submit"
                                        class="btn btn-primary pull-right">
                                    <a href="#"><i
                                            class=" fa fa-gear" style="color: white"></i></a>
                                </button>
                            </div>
                        </form>
                    {% endif %}


                    <!-- Post Details-->

                    <div hidden id="this_forum_id">{{ forum_id }}</div>
                    <a style="font-family: sans-serif;  color: black;  font-weight: bold ">Title:
                        &nbsp;&nbsp;</a><input maxlength="50" id="Title_element" type="text" name="title"
                                               style="border-radius: 4px;width: 60%;"><br><br>


                    <div class="form-group"><!--- Make a new Post-->

                        <label class="sr-only" for="message">post</label>
                        <textarea class="form-control" id="post_msg" rows="3"
                                  placeholder="What would you like to share?"></textarea>
                    </div>

                    <div class="form-group" style="display: inline-block; vertical-align: top;">
                        <!--attach file button-->

                        <a data-toggle="modal" data-target="#attachFileModal" style="color:#e83e8c;"><span
                                class="glyphicon glyphicon-paperclip"></span></a>
                        <a data-toggle="modal" data-target="#attachImageModal"
                           style="color:#e83e8c;margin-left: 5px;"><span
                                class="glyphicon glyphicon-picture"></span></a>


                    </div>
                    <!--post button-->
                    <div class="buttonbot" id="btnGetMessage_1"
                         style="position:absolute;left: 85%;display: inline-block;">
                        <button type="button"><strong>Post</strong></button>
                    </div>

                    <br>
                </div>


                <!-- End of Post Details-->


                <hr style="width: 100%; color: #e83e8c; height: 2px; background-color:#e83e8c; margin-top: 5px">
                <br>
                <!-- Post /////-->
                <br><br><!--spaces between posts-->
                <!-- End of Post /////-->

                <!-- Actual Post Dummy-->
                <div id="comment"></div>
                <div id="post_comment">


                </div>
                <!--- actual Posted message block-->
                {% comment %}<div style="border-style: solid;border-width: 2px;border-color: darkgray" class="messagePost">

                    <div class="panel-heading" style="background-color: #D3D3D3;">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="mr-2" style="display: inline-block; vertical-align: top;">
                                        <!--styling allows for the image and text to be next to one another-->
                                        <img class="rounded-circle" width="45" src="https://picsum.photos/50/50" alt="">
                                    </div>
                                    <div class="ml-2" style="display:inline-block;">
                                        <div class="h5 m-0"><strong> Kirsten Pennington</strong>
                                        </div>
                                    </div>
                                    <div style="margin-left: 50px;margin-top: -10px;font-size: x-small;font-style: italic"
                                         class=""><i class="fa fa-clock-o"></i> 10 min ago
                                    </div>

                                    <div class="dropdownmenu"
                                         style="display: inline-block;margin-left: 97%;color: #666666;position: relative; top: -55px;">
                                        <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                            <!--more options menu-->
                                            <span class="glyphicon glyphicon-option-vertical"
                                                  style="color: black;"></span></a>

                                            <ul class="dropdown-menu">

                                                <li onclick="Delete_post('-LjHx7ZqqoTe32nhvFht','-LjR8AlWuZAGc540fM0v')">
                                                    <a>Direct Message <span
                                                            class="glyphicon glyphicon glyphicon-comment pull-right"></span></a>
                                                </li>
                                                <li class="divider"></li>
                                                <li><a> Delete Post <span
                                                        class="fa fa-trash pull-right"></span></a>
                                                </li>
                                                <li class="divider"></li>
                                                <li><a>Report<span
                                                        class="    glyphicon glyphicon-warning-sign pull-right"></span></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </div>

                                    <h5 style="color:#e83e8c;margin-left: 50px; margin-top: -10px;font-weight: bold">
                                        Message Title goes here</h5>
                                </div>


                            </div>
                        </div>
                    </div>
                    <br>


                    <div class="card-body">

                        <p class="card-text;" style="font-family: sans-serif">
                            This card is still a dummy, you can use this to test your designs..
                        </p>

                        <!--this is the image which shows up on a post-->

                        <img  src="https://yt3.ggpht.com/a-/ACSszfFqU21Wtz5ap2GwjaGy7adiyLG6n3_cqlvI9A=s900-mo-c-c0xffffffff-rj-k-no"
                             style="width:200px; height:200px; margin-left: 30%;" >



                        <div style="margin-bottom: 0px; margin-left: 530px;font-weight: bold ">
                            <p onclick="Increase_Likes('-LjHxLAZzrskdrbwxU1z')"
                               style="color: #e83e8c;display: inline-block;vertical-align: top; font-weight: bold">10
                                &nbsp;<span class="glyphicon glyphicon-thumbs-up " style="color: #e83e8c; "></span>
                        </div>

                        <hr style="margin-top: 0px;color: darkgrey">
                    </div>


                    <div style=" margin-top: 0px;">
                        <!--styling ensures the like and comment are next to one another-->


                        <details style="outline: none;">

                            <summary style="color: #e83e8c;text-align: right"> <!--title of the replies collapsible-->
                                View Replies
                            </summary>


                            <!--Winny add message replies from here-->
                            <ul>
                                <a><img class="profile_img"
                                        src="http://gravatar.com/avatar/0e1e4e5e5c11835d34c0888921e78fd4?s=80"/> Name

                                    <i
                                            onclick="Delete_comment('-LjHx7ZqqoTe32nhvFht','-LjR8AlWuZAGc540fM0v')"
                                            class="fa fa-close" style="margin-left: 10px;"></i> </a>
                                <br><br>
                                <p style="color: black">Marketing 101, Video Assignment</p>

                                <div>


                                    <a id=""><textarea maxlength="200" id="-LjHDWtigiRAkkdKO3gw"
                                                       style="width: 90%;height: 25px;border-radius: 5px;"></textarea></a>
                                    <br>
                                    <button class="buttonbot2" onclick="saveComment('-LjHxLAZzrskdrbwxU1z')"
                                            style="position: absolute;left: 77%;" type="button">Reply
                                    </button>
                                </div>

                                <!--post button-->
                            </ul>

                        </details><!--end of collapasible--><!--end of collapasible-->

                        <!--Dummy Drop-down for comment_please don't remove-->
                    </div>

                </div> <!---//Message Post-->

<div style="border-style: solid;border-width: 2px;border-color: darkgray" class="messagePost">

                    <div class="panel-heading" style="background-color: #D3D3D3;">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="mr-2" style="display: inline-block; vertical-align: top;">
                                        <!--styling allows for the image and text to be next to one another-->
                                        <img class="rounded-circle" width="45" src="https://picsum.photos/50/50" alt="">
                                    </div>
                                    <div class="ml-2" style="display:inline-block;">
                                        <div class="h5 m-0"><strong> Kirsten Pennington</strong>
                                        </div>
                                    </div>
                                    <div style="margin-left: 50px;margin-top: -10px;font-size: x-small;font-style: italic"
                                         class=""><i class="fa fa-clock-o"></i> 10 min ago
                                    </div>

                                    <div class="dropdownmenu"
                                         style="display: inline-block;margin-left: 97%;color: #666666;position: relative; top: -55px;">
                                        <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                            <!--more options menu-->
                                            <span class="glyphicon glyphicon-option-vertical"
                                                  style="color: black;"></span></a>

                                            <ul class="dropdown-menu">

                                                <li onclick="Delete_post('-LjHx7ZqqoTe32nhvFht','-LjR8AlWuZAGc540fM0v')">
                                                    <a>Direct Message <span
                                                            class="glyphicon glyphicon glyphicon-comment pull-right"></span></a>
                                                </li>
                                                <li class="divider"></li>
                                                <li><a> Delete Post <span
                                                        class="fa fa-trash pull-right"></span></a>
                                                </li>
                                                <li class="divider"></li>
                                                <li><a>Report<span
                                                        class="    glyphicon glyphicon-warning-sign pull-right"></span></a>
                                                </li>
                                            </ul>
                                        </li>
                                    </div>

                                    <h5 style="color:#e83e8c;margin-left: 50px; margin-top: -10px;font-weight: bold">
                                        Message Title goes here</h5>
                                </div>


                            </div>
                        </div>
                    </div>
                    <br>


                    <div class="card-body">

                        <p class="card-text;" style="font-family: sans-serif">
                            This card is the dummy card with the file modal!
                        </p>

                        <!--this is the image which shows up on a post-->



                            <a href="https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Files%2FTest.pdf?alt=media&token=8ffc9bc6-9fff-4e9e-9366-1235580f5c64" target="_blank"> <img src="position: relative; top: 80%; right: 80%;" ></a>
"

                        <div style="margin-bottom: 0px; margin-left: 530px;font-weight: bold ">
                            <p onclick="Increase_Likes('-LjHxLAZzrskdrbwxU1z')"
                               style="color: #e83e8c;display: inline-block;vertical-align: top; font-weight: bold">10
                                &nbsp;<span class="glyphicon glyphicon-thumbs-up " style="color: #e83e8c; "></span>
                        </div>

                        <hr style="margin-top: 0px;color: darkgrey">
                    </div>


                    <div style=" margin-top: 0px;">
                        <!--styling ensures the like and comment are next to one another-->


                        <details style="outline: none;">

                            <summary style="color: #e83e8c;text-align: right"> <!--title of the replies collapsible-->
                                View Replies
                            </summary>


                            <!--Winny add message replies from here-->
                            <ul>
                                <a><img class="profile_img"
                                        src="http://gravatar.com/avatar/0e1e4e5e5c11835d34c0888921e78fd4?s=80"/> Name

                                    <i
                                            onclick="Delete_comment('-LjHx7ZqqoTe32nhvFht','-LjR8AlWuZAGc540fM0v')"
                                            class="fa fa-close" style="margin-left: 10px;"></i> </a>
                                <br><br>
                                <p style="color: black">Marketing 101, Video Assignment</p>

                                <div>


                                    <a id=""><textarea maxlength="200" id="-LjHDWtigiRAkkdKO3gw"
                                                       style="width: 90%;height: 25px;border-radius: 5px;"></textarea></a>
                                    <br>
                                    <button class="buttonbot2" onclick="saveComment('-LjHxLAZzrskdrbwxU1z')"
                                            style="position: absolute;left: 77%;" type="button">Reply
                                    </button>
                                </div>

                                <!--post button-->
                            </ul>

                        </details><!--end of collapasible--><!--end of collapasible-->

                        <!--Dummy Drop-down for comment_please don't remove-->
                    </div>

                </div> <!---//Message Post-->

                <br><br><!--spaces between posts-->{% endcomment %}


                <!-- End of Post /////-->


            </div>
            <!--rhs item-->
            <div class="col-md-3">
                <div class="card gedf-card">

                    {% load staticfiles %}

                    <img src="{{ forum_pic }}" style="width:60%; height: 600%;position: absolute;left:23%;">

                </div>

                <div class="form" style="border: 2px solid grey;border-radius: 5px; position: absolute; top: 360%; left: 15%;background-color: white; width: 250px;
                height: auto; ">


                    <div class="text-center"
                         style="font-family: 'Arial Narrow'; font-weight: bold; font-size: 13px; color: #8c8c8c; ">{{ forum_name }}
                    </div>


                    <!-- forum tags -->
                    <span class="badge badge-pill badge-dark text-center"
                          style="font-size: 11px;position: absolute; left: 25%; right: 25%; ">{{ forum_topics }}</span>
                    <br>

                    <hr style="width: 80%; color: #e83e8c; height: 2px; background-color:#e83e8c; margin-top: 5px"/>
                    <p style="color: #8c8c8c; padding-left: 2px;text-align: center;">{{ forum_description }}</p>

                    <a data-toggle="modal" data-target="#viewparticipants"
                       style="text-align: center;margin-left: 25%;color: #e83e8c;font-weight: bold"> View Participants
                        <i class="fa fa-angle-double-right"></i> </a>


                </div>

            </div>
        </div>
    </div>
</div>

</div>


<br>


</div>

</div>

<script>


    /* View Participants*/


    var users_details = firebase.database().ref().child("Users").child('{{ forum_creator }}');
    users_details.on("value", function (snapshot_forum_topics) {

        var forum_names = snapshot_forum_topics.val().Name;
        var forum_pics = snapshot_forum_topics.val().ProfilePic;
        var forum_c = snapshot_forum_topics.val().Country;


        var display_creator = " <img class=\"rounded-circle\" width=\"50\" height=\"50\"\n" +
            "                                                   src=\"" + forum_pics + "\"> " + forum_names;

        display_creator += "<br>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<p class=\"badge badge-pill badge-dark\" style=\"color:white;font-size:10px;margin-left:10px;margin-top;-2px;\"> " + forum_c + "</p>"


        $('#ID_Creator').html(display_creator);

    });


    var Participants_fb = firebase.database().ref().child("Forums").child('{{forum_id}}').child("Participants");
    Participants_fb.on("value", function (snapshot_user_topics) {
        $('#Title_ID').html('{{ forum_name }}');

        var j = 0;
        var result = "<table >";
        result += "<tr>";

        snapshot_user_topics.forEach(function (user_snapshot) {

            var user = user_snapshot.key;

            if (String(user).valueOf() != String('{{ forum_creator }}').valueOf()) {

                var users_details = firebase.database().ref().child("Users").child(user);
                users_details.on("value", function (snapshot_forum_topics) {

                    var forum_names = snapshot_forum_topics.val().Name;
                    var forum_pics = snapshot_forum_topics.val().ProfilePic;
                    var forum_num_BIO = snapshot_forum_topics.val().Bio;
                    var forum_num_country = snapshot_forum_topics.val().Country;


                    result += "<td>" + parts_All(forum_names, forum_num_BIO, forum_num_country, forum_pics) + "</td>";

                    if ((j + 1) % 2 == 0) {
                        result += "</tr><tr>";
                    }
                    j++;

                    $('#FP_modal').html(result);

                });
            }
        });


    });


    // get a snapshot of a list of keys from firebase and convert it to an array
    function snapshotToArrayKey(snapshot) {
        let returnArr = [];
        snapshot.forEach(childSnapshot => {
            //let item = childSnapshot.val();
            var key = childSnapshot.key;
            returnArr.push(key);
        });
        return returnArr;
    }

    function parts_All(name, bio, country, profilepic) {

        var card = "  <div class=\"col-md-2\"><!--USER PROFILE IMAGE GOES HERE-->\n" +
            "\n" +
            "                <img class=\"rounded-circle\" width=\"50\" height=\"50\" src=\"" + profilepic + "\"style=\"border: 1px solid \t#DCDCDC ; border-radius: 50px;\" alt=\"\">\n" +
            "\n" +
            "             </div><!--end col-->\n" +
            "\n" +
            "\n" +
            "             <div class=\"col-md-8\"><!--USERNAME AND IF THEY ARE A CONNECTION OR NOT -->\n" +
            "               <p style=\"margin-left:20px;margin-bottom:1px;font-size: 15px;\"> " + name + "  </p>\n" +
            "                &nbsp;&nbsp;&nbsp;<p class=\"badge badge-pill badge-dark\" style=\"color:white;font-size:10px;margin-left:10px;margin-top:2px;\"> " + country + "</p>\n" +
            "\n" +
            "             </div><!--end col-->\n" +
            "\n" +
            "             \n";

        return card;

    }


    // number_of_participants_in_forum

    var forum_number = firebase.database().ref().child("Forums").child('{{forum_id}}').child("Participants");
    forum_number.on("value", function (snapshot_user_topics) {


        var countholder = 0;

        snapshot_user_topics.forEach(function (a) {
            countholder++;
        });
        countholder--;

        $('#number_of_participants_in_forum').html(countholder);

    });


    /* View Participants*/


</script>

<script>

    /**Fetching document to be attached*/


    function closeFile_1() {
        document.getElementById("File_Link").value = "";
        document.getElementById("File_Frame").src = "";
    }

    function closeImage_1() {
        document.getElementById("frameImage").value = "";
        document.getElementById("viewframe").src = "";
    }


    function ViewFile() {
        document.getElementById("File_Frame").src = document.getElementById("File_Link").value;
    }

    function ViewImage() {
        document.getElementById("viewframe").src = document.getElementById("frameImage").value;
    }


    var database_msgs = firebase.database().ref().child("Forums/" + '{{forum_id}}' + "/Messages");/*Messages*/

    // window.alert('{{forum_id}}');

    $('#btnGetMessage_1').click(function () {

        var Document = "";
        var isDocument = "No_File"

        var AttachFile = "";
        var AttachImage = "";

        AttachFile = document.getElementById("File_Link").value;
        AttachImage = document.getElementById("frameImage").value;

        if ((AttachImage.length != 0) && (AttachFile.length != 0)) {
            //window.alert("You can only attach one document to a post")
            $("#modalOneFile").modal('show');

            return;
        }

        if (String(AttachImage).valueOf() != String("").valueOf() || String(AttachFile).valueOf() != String("").valueOf()) {
            if (String(AttachImage).valueOf() == String("").valueOf()) {
                Document = AttachFile;
                isDocument = "File";
            } else {
                Document = AttachImage;
                isDocument = "Image"
            }
        } else {
            Document = "";
        }

        document.getElementById("File_Link").value = "";
        document.getElementById("frameImage").value = "";
        document.getElementById("File_Frame").src = "";
        document.getElementById("viewframe").src = "";


        /*Fetching time when items were pushed*/
        var upload_document = "";
        var d = new Date(),
            minutes = d.getMinutes().toString().length == 1 ? '0' + d.getMinutes() : d.getMinutes(),
            hours = d.getHours().toString().length == 1 ? '0' + d.getHours() : d.getHours(),
            ampm = d.getHours() >= 12 ? 'pm' : 'am',
            months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        dateTime = days[d.getDay()] + ' ' + months[d.getMonth()] + ' ' + d.getDate() + ' ' + d.getFullYear() + ' ' + hours + '' + minutes;
        /*dateTime = hours + ':' + minutes + ampm;*/

        var post_message = document.getElementById("post_msg").value;
        var mesaage_title = document.getElementById("Title_element").value;
        document.getElementById("post_msg").value = "";
        document.getElementById("Title_element").value = "";


        var date_for_post = Date.now();


        /* Check for document being uploaded*/

        {% comment %}var isDocument; /* Can either be Image, File or No_File*/

        if (String(AttachFile).valueOf() == String("").valueOf()){upload_document = AttachImage; isDocument="Image"}
        else {upload_document = AttachFile; isDocument="File"}

        if (upload_document.toString()==""){ isDocument="No_File"}{% endcomment %}

        /* Check Complete*/


        /*Changing items in the db*/
        writeUserData(date_for_post, "{{this_uid}}", post_message, "0", "0", "{{ username }}", "{{ profilePic }}", mesaage_title, Document, isDocument);
        date_for_post;
        post_message;
        "{{this_uid}}";
        "0";
        "0";
        "{{ username }}";
        "{{ profilePic }}";
        Title_element;
        Document;
        isDocument
    });

    /*Whenever items changes (added, modified, deleted) in database, this event is called*/

    database_msgs.on('value', function (snapshot) {

        renderUI(snapshot.val());


    });


    /*Push time entered and Message entered from textboxes, creates entry in firebase
    * push gives a unique key*/

    function writeUserData(message_time, messageFrom, actual_message, likes_num, comments_num_default, username, profilePic, Title_element, Document, isDocument) {/*Pushes to current users*/

//window.alert(Title_element);

        var created_id = database_msgs.push();
        created_id.set({
            DateTime: message_time,
            sender: messageFrom,
            text: actual_message,
            likes: likes_num,
            comments_num: comments_num_default,
            sender_name: username,
            sender_profilePic: profilePic,
            title: Title_element,
            document: Document,
            isDocument: isDocument

        });


        /*Saving_id*/
        var hope = String(created_id);
        var result = hope.substring(hope.lastIndexOf("/") + 1);
        var save_id = firebase.database().ref().child("Forums/" + '{{forum_id}}' + "/Messages/" + result);/*Messages*/
        save_id.update({
            post_id: result
        });

    }


    /*Always refreshing data being loaded*/
    function renderUI(obj) {

        var html = "";
        var ifempty = true;
        var ProfilePic = '{{ profilePic }}'

        try {

            var keys = Object.keys(obj);

            for (var i = keys.length - 1; i >= 0; i--) {


                var display_time = obj[keys[i]].DateTime;
                display_time = Number(display_time); // cast it to a Number
                var ts_display = timeAgo(display_time);

                var commects_object = obj[keys[i]].comments;

                var profile = "";

                var database_userdetails = firebase.database().ref().child("Users/" + obj[keys[i]].sender);/*Current users account*/
                var username_name = "Nothing";

                /*Name and Picture*/
                database_userdetails.on("value", function (snapshot) {
                    var username_check;
                    username_check = snapshot.val().Name;
                    username_name = username_check;
                });


                var num = getComments_num(obj[keys[i]].post_id);
                var num_likes = getLikes_num(obj[keys[i]].post_id);

                /*Counter for comments*/


                html += "       <div  style=\"border-style: solid;border-width: 2px;border-color: darkgray\" class=\"messagePost\" >\n" +
                    "\n" +
                    "                        <div style=\"background-color: #D3D3D3; \" class=\"panel-heading\">\n" +
                    "                        <div class=\"card-header\">\n" +
                    "                            <div class=\"d-flex justify-content-between align-items-center\">\n" +
                    "                                <div class=\"d-flex justify-content-between align-items-center\">\n" +
                    "                                    <div class=\"mr-2\" style=\"display: inline-block; vertical-align: top;\">\n" +
                    "                                        <!--styling allows for the image and text to be next to one another-->\n" +
                    "                                        <img class=\"rounded-circle\" width=\"45\" src=\"" + obj[keys[i]].sender_profilePic + "\" alt=\"\">\n" +
                    "                                    </div>\n" +
                    "                                    <div class=\"ml-2\" style=\"display:inline-block;\">\n" +
                    "                                        <div class=\"h5 m-0\"><strong> " + obj[keys[i]].sender_name + "</strong>\n" +
                    "                                           </div>\n" +
                    "                                    </div><div style=\"margin-left: 50px;margin-top: -10px;font-size: x-small;font-style: italic\" class=\"\"><i  class=\"fa fa-clock-o\"></i> " + ts_display + "</div>\n" +
                    "\n" +
                    "                                    <div class=\"dropdownmenu\"\n" +
                    "                                         style=\"display: inline-block;margin-left: 97%;color: #666666;position: relative; top: -55px; \">\n" +
                    "                                        <li class=\"dropdown\"><a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n" +
                    "                                            <!--more options menu-->\n" +
                    "                                            <span class=\"glyphicon glyphicon-option-vertical\" style=\"color: black;\"></span></a>\n" +
                    "\n" +
                    "                                            <ul class=\"dropdown-menu\">\n" +
                    "\n" +
                    "                                                \n" +
                    "                                                <li class=\"divider\"></li>\n" +
                    "                                                  <li  onclick=\"Delete_post(\'" + obj[keys[i]].post_id + "\',\'" + obj[keys[i]].sender + "\')\"  ><a> Delete Post <span\n" +
                    "                                                        class=\"fa fa-trash pull-right\"></span></a>\n" +
                    "                                                </li>\n" +
                    "                                                 <li class=\"divider\"></li>\n" +
                    "                                               \n" +
                    "                                            </ul>\n" +
                    "                                        </li>\n" +
                    "                                    </div>\n" +
                    "\n" +
                    "                                    <h5 style=\"color:#e83e8c;margin-left: 50px; margin-top: -10px;font-weight: bold\"> " + obj[keys[i]].title + "</h5>\n" +
                    "                                </div>\n" +
                    "\n" +
                    "\n" +
                    "                            </div>\n" +
                    "                        </div></div><br>\n" +
                    "\n" +
                    "\n" +
                    "                        <div class=\"card-body\">\n" +
                    "\n" +
                    "                            " + DisplayDocument(obj[keys[i]].isDocument, obj[keys[i]].document) + "" +
                    "" +
                    "<br><br><p class=\"card-text;\" style=\"font-family: sans-serif\">\n" +
                    "                                " + obj[keys[i]].text + "\n" +
                    "                            </p>\n" +
                    "\n" +
                    "                            <div style=\"margin-bottom: 0px; margin-left: 530px;font-weight: bold \">\n" +
                    "                                <p onclick=\"Increase_Likes(\'" + obj[keys[i]].post_id + "\')\"style=\"color: #e83e8c;display: inline-block;vertical-align: top; font-weight: bold\">" + num_likes + " &nbsp;<span class=\"glyphicon glyphicon-thumbs-up \" style=\"color: #e83e8c; \"></span>\n" +
                    "                            </div>\n" +
                    "\n" +
                    "                            <hr style=\"margin-top: 0px;color: darkgrey\">\n" +
                    "                        </div>\n" +
                    "\n" +
                    "\n" +
                    "\n" +
                    "\n" +
                    "\n" +
                    "                        <div style=\" margin-top: 0px;\">\n" +
                    "                            <!--styling ensures the like and comment are next to one another-->\n" +
                    "\n" +
                    "\n" +
                    "                            <details style=\"outline: none; \">\n" +
                    "\n" +
                    "                                <summary style=\"color: #e83e8c;margin-left: 450px;font-weight: bold\"> <!--title of the replies collapsible-->\n" +
                    "                                    View " + getComments_num(obj[keys[i]].post_id) + " Replies &nbsp \n" +
                    "                                </summary>\n" +
                    "\n" +
                    "\n" +
                    "                                <!--Winny add message replies from here-->\n" +
                    "                                <ul style=\"margin-left: -30px\">\n" +
                    "                                   " + Reply_list(obj[keys[i]].post_id) + " \n" +
                    "\n" +
                    "                                        \n" +
                    "                                    \n" +
                    "                                        \n" +
                    "                                    \n" +
                    "\n" +
                    "                                        \n" +
                    "\n" +
                    "                                      <img class=\"rounded-circle\" width=\"45\" src=\"" + "{{ profilePic }}" + "\" alt=\"\">  <a id=\"\"><textarea maxlength=\"200\" placeholder=\"Reply to this post\" id=\"" + obj[keys[i]].post_id + "\" style=\"width: 451px;height: 30px;border-radius: 5px; border-style: solid;border-width: 2px;border-color: darkgray;position: relative;top:15px\"></textarea></a>\n" +
                    "                                       <br>\n" +
                    "                                        <button class=\"buttonbot2\" onclick=\"saveComment(\'" + obj[keys[i]].post_id + "\')\" style=\"position: relative;left:505px;top:-32px\" type=\"button\">Reply</button>\n" +
                    "                                    </div>\n" +
                    "\n" +
                    "                                    <!--post button-->\n" +
                    "                                </ul>\n" +
                    "\n" +
                    "                            </details><!--end of collapasible-->\n" +
                    "\n" +
                    "                            <!--Dummy Drop-down for comment_please don't remove-->\n" +
                    "                        </div>\n" +
                    "\n" +
                    "                </div> <!---//Message Post-->\n" +
                    "\n" +
                    "                <br><br><!--spaces between posts-->";

            }
        } catch (e) {


            html = " <div class=\"container_2\">\n" +
                "                        <img style=\"height: 400px;width: 1365px; opacity: 0.2; width:100%;\"\n" +
                "                             src=\"https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/images%2FprofileHeaders%2Fnoconnections.jpg?alt=media&token=0f232c78-956b-46eb-85c6-f4a483fd480a\"\n" +
                "                             alt=\"Snow\">\n" +
                "                        <div class=\"centered\"><strong><h1\n" +
                "                                style=\"font-family: 'Roboto', sans-serif; color: deeppink;margin-top: -200px;margin-left: 50px \">\n" +
                "                            Be the first to post in the group!</h1></strong></div>\n" +
                "                    </div><br><br><br><br><br><br><br><br><br><br>";

        }


        $('#post_comment').html(html);

    }

    function DisplayDocument(isDocument, document_1) {


        var document_display = "";

        if (String(isDocument).valueOf() == String("Image").valueOf()) {

            {% comment %}
                        document_display = " <img href=\""+ document_1 +"\" target=\"_blank\" src=\" "+  document_1 +"\" style=\"width:200px; height:200px; margin-left: 30%;\" > ";
            {% endcomment %}


            document_display = "<a style=\"width:200px; height:200px; margin-left: 30%;\"  href=\"" + document_1 + "\" target=\"_blank\"> \n" +
                "<img width=\"220\" height=\"250\" border=\"0\" align=\"center\"  src=\"" + document_1 + "\"/> \n" +
                "</a>"


        } else {

            if (String(isDocument).valueOf() == String("File").valueOf()) {

                document_display = "<a style=\"position: relative; top: 80px;color:deeppink ; left:5px\" href=\"" + document_1 + "\" target=\"_blank\"> <span\n" +
                    "                                    class=\"glyphicon glyphicon-paperclip\"></span></a>\n";


            } else {


            }

        }

        return document_display;

    }


    function display_modal(link_file) {

        {% comment %} document.getElementById("frameView_popup").src =link_file;

          $('#fileViewModal').modal('show');{% endcomment %}

        //window.alert("hey");


    }


    <!--script for shwoing and hiding comments-->
    $(document).ready(function () {

        $(".btn-comment").click(function () {
            $(".collapse").collapse('show');
        });
        $(".btn-close").click(function () {
            $(".collapse").collapse('hide');
        });
    });


    <!--Dummy Drop-down for comment_please don't remove-->


    function Increase_Likes(holder) {

        var commentID = String(holder);

        //Check if any users exist
        firebase.database().ref("Forums/" + '{{ forum_id }}' + "/Messages/" + commentID + "/likes_ids/" + '{{ this_uid }}').once("value", snapshot => {
            if (snapshot.exists()) {

                var like_IDs = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + commentID + "/likes_ids");/*Messages*/

                like_IDs.child("{{ this_uid }}").remove();
            } else {
                var like_IDs = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + commentID + "/likes_ids");/*Messages*/

                like_IDs.child("{{this_uid}}").set("{{this_uid}}");
            }

        });


    }

    function Delete_comment(message_id, comment_id, sending) {

        if (sending.trim().toString() == String('{{this_uid}}')) {


            var like_IDs = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + message_id + "/comments");/*Messages*/

            like_IDs.child(comment_id).remove();
        } else {

            $("#deleteCommentModal").modal('show');
        }


    }

    function Delete_post(post_id, sender) {


        if (sender.trim().toString() == String('{{this_uid}}')) {

            var like_IDs = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages");/*Messages*/

            like_IDs.child(post_id).remove();
        } else {
            $("#modalDeletePost").modal('show');
        }


    }


    function saveComment(holder) {

        /*Messages*/


        commentID = String(holder);
        var database_msgs_comment = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + commentID + "/comments");/*Messages*/


        /*Changing items in the db*/

        var time_comment = Date.now();
        var actualcomment = document.getElementById(commentID).value;
        document.getElementById(commentID).value = "";

        /*Push time entered and Message entered from textboxes, creates entry in firebase
        * * * push gives a unique key*/


        var created_id = database_msgs_comment.push();
        created_id.set({
            DateTime: time_comment,
            sender: "{{this_uid}}",
            text: actualcomment,
            likes: "0",
            sender_name: "{{ username }}",
            sender_profilePic: "{{ profilePic }}"

        });


        /*Saving_id*/
        var hope = String(created_id);
        var result = hope.substring(hope.lastIndexOf("/") + 1);
        var save_id = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + commentID + "/comments/" + result);/*Messages*/

        save_id.update({
            post_id: result
        });


    }


    function fetch_name(sender) {


        return test;
    }

    function Reply_list(holder) {
        var return_string = "";


        comments_object = String(holder);

        var database_msgs_comment = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + comments_object + "/comments");/*Messages*/
        var countholder = 0;


        database_msgs_comment.on("value", function (snapshot) {
            snapshot.forEach(function (child) {


                var txt_txt = String(child.val().text);
                var comment_post_id = String(child.val().post_id);
                var user_name = String(child.val().sender_name);
                var user_pic = String(child.val().sender_profilePic);
                var sending = String(child.val().sender);


                return_string = return_string + "  <a style=\"color: black;font-family: sans-serif;font-weight: bold\"><img  class=\"rounded-circle\" width=\"45\" src=\"" + user_pic + "\" alt=\"\"> " + user_name + " </a>\n" +
                    "\n" +
                    "                                        <i onclick=\"Delete_comment(\'" + comments_object + "\',\'" + comment_post_id + "\',\' " + sending + "\' )\" class=\"fa fa-close\" style=\"margin-left: 10px;\"></i> \n" +
                    "                                    <br>\n" +
                    "                                        <p style=\"color: black;font-family: sans-serif;margin-left: 50px;margin-top: -15px\">" + txt_txt + "</p>\n" +
                    "                                    \n" +
                    "\n" +
                    "                                        <br>";
                countholder++;


            });
        });


        return return_string;
    }


    function getComments_num(holder) {


        comments_object = String(holder);
        var database_msgs_comment = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + comments_object + "/comments");/*Messages*/
        var countholder = 0;

        database_msgs_comment.on("value", function (snapshot) {
            snapshot.forEach(function (child) {

                countholder++;

            });
        });


        return countholder;
    }


    function getLikes_num(holder) {


        comments_object = String(holder);
        var database_msgs_comment = firebase.database().ref().child("Forums/" + '{{ forum_id }}' + "/Messages/" + comments_object + "/likes_ids");/*Messages*/
        var countholder = 0;

        database_msgs_comment.on("value", function (snapshot) {
            snapshot.forEach(function (child) {

                countholder++;

            });
        });


        return countholder;
    }


</script>


<!-- Page Footer-->
<footer class="page-footer font-small cyan darken-3" style="background-color: #D3D3D3;">


    <div class="container">
        <br></br>
        <!-- Call to action -->
        <ul class="list-unstyled list-inline text-center py-2">
            <li class="list-inline-item">
                <!--  <h5 class="mb-1">Log in now: </h5>-->
            </li>
            <li class="list-inline-item">


                <div class="row"><!--table row-->

                    <div class="col-sm-3" style="text-align:left;padding-right: 100px;">
                        <br>
                        {% load staticfiles %}
                        <img src="{% static "GC_Auth/logotrans.png" %}" alt="lock"
                             class="image">
                    </div>


                    <div class="col-sm-3" style="text-align:left;padding-left: 120px;">

                        <p style="color:#e83e8c;font-size:20px;"><strong>Menu</strong></p>
                        <a onclick="location.href='{% url 'nav_home' %}'" style="color: white">
                            <p>Home</p></a>
                        <a onclick="location.href='{% url 'nav_networks' %}'"
                           style="color: white"><p>Connections</p>
                        </a>
                        <a onclick="location.href='{% url 'nav_forums' %}'"
                           style="color: white"><p>Forums</p></a>
                        <a onclick="location.href='{% url 'nav_courses' %}'"
                           style="color: white"><p>Courses</p></a>
                    </div>

                    <div class="col-sm-3" style="text-align:left;padding-left: 80px;">
                        <!--coloumn-->

                        <p style="color:#e83e8c;font-size:20px;"><strong>Help & FAQs</strong>
                        </p>

                        <a onclick="location.href='{% url 'introHelp' %}'" style="color: white">
                            <p>What is
                                GetConnected?</p></a>
                        <a onclick="location.href='{% url 'accountHelp' %}'"
                           style="color: white"><p>Your Account</p>
                        </a>
                        <a onclick="location.href='{% url 'forumsHelp' %}'" style="color: white">
                            <p>Forums & Messaging</p></a>
                        <a onclick="location.href='{% url 'helpconnections' %}'" style="color: white">
                            <p>Connection
                                Management</p></a>
                        <a onclick="location.href='{% url 'helpcourses' %}'" style="color: white">
                            <p>Courses Help</p></a>
                        <a href="https://www.getsmarter.com/what-we-do" style="color: white"><p>
                            GetSmarter</p></a>


                    </div>

                    <div class="col-sm-3" style="text-align:left;padding-left: 80px;">
                        <!--coloumn-->

                        <p style="color:#e83e8c;font-size:20px;"><strong>Contact Us</strong></p>
                        <p style="color:white;"><strong>Tel: </strong> 456 4637</p>
                        <p style="color:white;"><strong>Email: </strong>
                            getConnected@GetSmarter.co.za</p>
                        <p style="color:white;"><strong>Working Hours:</strong> Mon - Fri, 09:00
                            - 17:00</p>


                    </div>


                </div>

                <br>
                <br>


            </li>
        </ul>
        <!-- Call to action -->

    </div>
    </div>
</footer>

<!-- Confirm Leaving Forum Popup -->


<div class="modal fade" id="mi-modal" role="dialog">
    <div class="modal-dialog">

        <div class="modal-content">
            <div class="modal-body" style="padding:10px;">
                <h4 class="text-center">Are you sure you want to leave this forum?</h4>
                <br>
                <div class="text-right">
                    <a id="modal-btn-si" class="btn btn-yes" style=" border: 1px solid gray;
            color: #e83e8c;">
                        Confirm</a>
                    <a class="btn btn-no" id="modal-btn-no" style=" border: 1px solid gray;
            color: #e83e8c;">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>


<script>

    // leave forum functionality for confirm dialogue using Bootstrap modal
    var modalConfirm = function (callback) {

        $("#btn-confirm").on("click", function () {
            $("#mi-modal").modal('show');
        });

        $("#modal-btn-si").on("click", function () {
            callback(true);
            $("#mi-modal").modal('hide');
        });

        $("#modal-btn-no").on("click", function () {
            callback(false);
            $("#mi-modal").modal('hide');
        });
    };

    // results of the confirmation
    modalConfirm(function (confirm) {
        if (confirm) {          // Leave Forum confirmed

            removeUserRef = firebase.database().ref("Forums").child('{{ forum_id }}').child("Participants").child('{{ this_uid }}');  // remove the user id from forum participants
            removeUserRef.remove();

            removeForumRef = firebase.database().ref("Users").child('{{ this_uid }}').child("ForumsJoined").child('{{ forum_id }}');  // remove forum from user's forumsjoined
            removeForumRef.remove();

            getNumParticipantsRef = firebase.database().ref("Forums").child('{{ forum_id }}').child("NumParticipants");         // reduce nunm participants in this forum
            getNumParticipantsRef.once('value', function (snapshot) {
                numParticipants = snapshot.val();              // get the current number of participants

                json_dict = {NumParticipants: numParticipants - 1};   // reduce num participants by 1

                reduceNumParticipantsRef = firebase.database().ref("Forums").child('{{ forum_id }}');
                reduceNumParticipantsRef.update(json_dict);         // update database

                $("#modalLeftForum").modal('show');
            });
            // notify user that they have been removed from forum
        } else {                //Do not leave forum
            $("#mi-modal").modal('hide');
        }
    });


</script>

<!--Modal to attach a file-->
<div class="modal fade" id="attachFileModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="vertical-align-center" role="document">
        <div class="modal-content" style="width: 1000px;margin-left: 15%;">
            <div class="modal-header">
                <button onclick="closeFile_1()" id="Close_Attach_File" type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h5 class="modal-title" id="exampleModalLabel"><strong>Attach a File </strong></h5>
            </div>

            <div class="modal-body">

                <div class="row">

                    <div class="col-md-2"></div>
                    <div class="col-md-7">
                        <div class="form-group"><!--- file link input-->

                            <label class="sr-only" for="message">post</label>
                            <textarea class="form-control" id="File_Link" rows="1"
                                      placeholder="Insert File Link Here"></textarea>
                        </div>
                    </div><!--end col-->

                    <div class="col-md-3">
                        <button type="button" class="btn btn-secondary" onclick="ViewFile()"
                                style="border: 1px solid gray; color: #e83e8c; background-color: white;">View
                        </button>
                    </div><!--end col -->
                </div><!-- end row-->
                <iframe id="File_Frame" src=""
                        style="width:900px; height:500px;margin-left: 3%;" frameborder="0"></iframe>


            </div>

            <div class="modal-footer">
                <button onclick="closeFile_1()" id="Cancel_Attach_File" type="button"
                        class="btn btn-secondary pull-left" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Cancel
                </button>
                <button id="Attach_File" type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Attach
                </button>

            </div>


        </div>
    </div>
</div>

<!--Modal to attach an image-->
<div class="modal fade" id="attachImageModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="vertical-align-center" role="document">
        <div class="modal-content" style="width: 1000px;margin-left: 15%;">
            <div class="modal-header">
                <button onclick="closeImage_1()" id="Close_Attach_File" type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h5 class="modal-title" id="exampleModalLabel"><strong>Attach an Image </strong></h5>
            </div>

            <div class="modal-body">

                <div class="row">

                    <div class="col-md-2"></div>
                    <div class="col-md-7">
                        <div class="form-group"><!--- file link input-->

                            <label class="sr-only" for="message">post</label>
                            <textarea class="form-control" id="frameImage" rows="1"
                                      placeholder="Insert File Link Here"></textarea>
                        </div>
                    </div><!--end col-->

                    <div class="col-md-3">
                        <button type="button" class="btn btn-secondary" onclick="ViewImage()"
                                style="border: 1px solid gray; color: #e83e8c; background-color: white;">View
                        </button>
                    </div><!--end col -->
                </div><!-- end row-->
                <iframe id="viewframe" src=""
                        style="width:900px; height:500px;margin-left: 3%;" frameborder="0"></iframe>


            </div>

            <div class="modal-footer">
                <button onclick="closeImage_1()" id="Cancel_Attach_File" type="button"
                        class="btn btn-secondary pull-left" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Cancel
                </button>
                <button id="Attach_File" type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Attach
                </button>

            </div>


        </div>
    </div>
</div>

<!-- Modal for pop up message "Delete_post" -->
<div class="modal fade" id="modalDeletePost" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><strong>Cannot Delete Post</strong></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                You can only delete your own posts
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Close
                </button>

            </div>
        </div>
    </div>
</div>


<!-- Modal for pop up message "you can only attach one" -->
<div class="modal fade" id="attachOneOnlyModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><strong>Cannot Attach</strong></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                You can only attach one file to a post.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Close
                </button>

            </div>
        </div>
    </div>
</div>

<!-- Modal for pop up message "Delete_comment" -->
<div class="modal fade" id="deleteCommentModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><strong>Cannot Delete Comment</strong></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                You can only delete your own comments
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Close
                </button>

            </div>
        </div>
    </div>
</div>

<!-- Modal for pop up message "File Viewing" -->

<div class="modal fade" id="fileViewModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="vertical-align-center" role="document">
        <div class="modal-content" style="width: 1000px;margin-left: 15%;">
            <div class="modal-header">
                <button onclick="closeFile_1()" id="Close_Attach_File" type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h5 class="modal-title" id="exampleModalLabel"><strong>View File </strong></h5>
            </div>

            <div class="modal-body">


                <iframe id="frameView_popup" src=""
                        style="width:900px; height:500px;margin-left: 3%;" frameborder="0"></iframe>


            </div>

            <div class="modal-footer">

                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Okay
                </button>

            </div>


        </div>
    </div>
</div>

</body>
<!-- Modal for pop up message "User has left forum" -->
<div class="modal fade" id="modalLeftForum" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><strong>Forum Left</strong></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                You have left this forum. You may post a goodbye message but once you exit the forum, you will not be
                able to view the forum again.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Close
                </button>

            </div>
        </div>
    </div>
</div>


{% comment %}
Badges_Celebrations_3
{% endcomment %}
<script>

    //Badge_1_Friend_Finder

    var FriendFinder_Connections = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Connections");

    FriendFinder_Connections.on("value", function (snapshot) {

        var counter = 0;

        snapshot.forEach(function (childSnapshot) {
            counter++;
        });

        if (counter >= 1 && counter < 5) {
            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {
                var text = "Friend Finder Badge";

                if (snapshot.val().FriendFinder == "not_celebrated") {
                    $('#Congrats_Pop_Up').html(text);
                    $("#Celebrations").modal();

                    checkCelebration.update({'FriendFinder': "celebrated"});
                }
            });
        } else {
        }


        //Badge_2_NetoworkingNinja

        if (counter >= 5 && counter < 10) {

            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {
                var text = "Networking Ninja Badge";
                if (snapshot.val().NetworkingNinja == "not_celebrated") {
                    $('#Congrats_Pop_Up').html(text);
                    $("#Celebrations").modal();
                    checkCelebration.update({'NetworkingNinja': "celebrated"});
                }

            })

        } else {
        }


        //Badge_3_CrazyConnector

        if (counter >= 10 && counter < 15) {


            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {
                var text = "Crazy Connector Badge";


                if (snapshot.val().CrazyConnector == "not_celebrated") {
                    $('#Congrats_Pop_Up').html(text);
                    $("#Celebrations").modal();
                    checkCelebration.update({'CrazyConnector': "celebrated"});


                }

            })

        } else {
        }


        //Badge_4_PopularProfile

        if (counter >= 15) {


            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {
                var text = "Popular Profile Badge";

                if (snapshot.val().PopularProfile == "not_celebrated") {
                    $('#Congrats_Pop_Up').html(text);
                    $("#Celebrations").modal();
                    checkCelebration.update({'PopularProfile': "celebrated"});


                }

            })

        } else {


        }


    });

    //Badge_5_BrightSpark

    var Badges_for_Courses = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Courses");

    Badges_for_Courses.on("value", function (snapshot) {

        var counter = 0;

        snapshot.forEach(function (childSnapshot) {
            counter++;
        });


        if (counter >= 3 && counter < 5) {

            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {
                var text = "Bright Spark Badge";

                if (snapshot.val().BrightSpark == "not_celebrated") {
                    $('#Congrats_Pop_Up').html(text);
                    $("#Celebrations").modal();
                    checkCelebration.update({'BrightSpark': "celebrated"});

                }

            })

        } else {
        }


        //Badge_6_FabAcademic

        if (counter >= 5 && counter < 10) {

            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {
                var text = "FabAcademic Badge";


                if (snapshot.val().FabAcademic == "not_celebrated") {
                    $('#Congrats_Pop_Up').html("FabAcademic Badge");
                    $("#Celebrations").modal();
                    checkCelebration.update({'FabAcademic': "celebrated"});


                }

            })

        } else {
        }


        //Badge_7_Got_Smarter


        if (counter >= 10) {


            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {
                var text = "GotSmarter Badge";

                if (snapshot.val().GotSmarter == "not_celebrated") {
                    $('#Congrats_Pop_Up').html("GotSmarter Badge");
                    $("#Celebrations").modal();

                    checkCelebration.update({'GotSmarter': "celebrated"});


                }

            })

        } else {


        }


    });

    //Badge_8_Got_Smarter

    //Badge_9_Forum_Boffin

    var Badges_for_Forums = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/ForumsJoined");

    Badges_for_Forums.on("value", function (snapshot) {

        var counter = 0;

        snapshot.forEach(function (childSnapshot) {
            counter++;
        });

        if (counter >= 5) {


            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {

                if (snapshot.val().ForumBoffin == "not_celebrated") {
                    var text = "GotSmarter Badge";
                    $('#Congrats_Pop_Up').html("ForumBoffin Badge");
                    $("#Celebrations").modal();
                    checkCelebration.update({'ForumBoffin': "celebrated"});

                }

            })

        } else {


        }

    });


    //Badge_10_Forum_Boffin
    var Badges_for_Badges_Private = firebase.database().ref().child("Users/" + '{{ this_uid }}');

    Badges_for_Badges_Private.on("value", function (snapshot) {

        var isPrivate = snapshot.val().privacyUpdated;
        var display_1 = "";


        if (isPrivate == "yes") {

            display_1 = "<img src=\"https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Badges%2FsuperSecurity.png?alt=media&token=503cf33c-c79b-4710-b12d-ffbb2a7477b7\" alt= \"lock\" class=\"image\" >\n" +
                "\n" +
                "                <div class=\"middle\">\n" +
                "                   <div class=\"text\"><strong>Super Security</strong> <br> Updated you Privacy Settings</div>\n" +
                "                     <!--text for the hover-->\n" +
                "                 </div>";

            var checkCelebration = firebase.database().ref().child("Users/" + '{{ this_uid }}' + "/Badges");
            checkCelebration.on("value", function (snapshot) {

                if (snapshot.val().SuperSecurity == "not_celebrated") {
                    var text = "Super Security Badge";
                    $('#Congrats_Pop_Up').html("Super Security Badge");
                    $("#Celebrations").modal();
                    checkCelebration.update({'SuperSecurity': "celebrated"});

                }

            })

        } else {

            display_1 = "<img src=\"https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Badges%2FlockCircle.png?alt=media&token=d204d5fe-9d37-4269-9e73-0a54571a5ce6\" alt= \"lock\" class=\"image\" >\n" +
                "                    <div class=\"middle\">\n" +
                "                        <div class=\"text\"><strong>Oops!</strong> <br> Badge Locked</div>\n" +
                "                         <!--text for the hover-->\n" +
                "                     </div>";
        }

        $('#SuperSecurity').html(display_1);
    });


</script>
{% comment %}
Badges_Celebrations_1
{% endcomment %}

<div id="Celebrations" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div style="" class="modal-content">
            <div style="" class="modal-header">

                <img style="margin-left: 30px; width: 100px; height: 100px"
                     src="https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Badges%2Fstuffcelebration.gif?alt=media&token=77be32d2-cdbb-4356-ba92-bc8fc69ca31c">
                <img style="margin-left: 30px; width: 100px; height: 100px"
                     src="https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Badges%2Fparty_face_256_1.gif?alt=media&token=4c859e3c-a29b-469e-b275-5208cff0e46d">
                <img style="margin-left: 30px; width: 100px; height: 100px"
                     src="https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Badges%2Fconfetti_ball_256.gif?alt=media&token=28226457-860e-48db-b443-07052b333515">
                <img style="margin-left: 30px; width: 100px; height: 100px"
                     src="https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Badges%2Fstuffcelebration.gif?alt=media&token=77be32d2-cdbb-4356-ba92-bc8fc69ca31c">

                <h1 style="margin-left: 140px; color: orange">Congratulations!!!!</h1>
                <h3 style="margin-left: 140px; color: purple">You unlocked a new badge!</h3>
                <h4 id="Congrats_Pop_Up" style=" margin-left: 200px; color: orangered; font-style: italic"></h4>


                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <br>
            <img style="margin-left: 50px"
                 src="https://firebasestorage.googleapis.com/v0/b/getconnected-9dac0.appspot.com/o/Badges%2Ftumblr_inline_pk7haw87391r9r3iy_540.gif?alt=media&token=f11fda16-ae48-4560-9abd-c5e4dd78a141">

            <div class="modal-body">


                <div id="ConnectionsListing_All" class="row">


                </div> <!--end row-->


                <div class="modal-footer">


                </div>
            </div>
        </div>
    </div>
</div>

{% comment %}
Badges_Celebrations_2
{% endcomment %}
<script>

    $('#Celebrations').on('show.bs.modal', function (event) {

    })
</script>


<!--View Participants Modal-->

<div class="modal fade" id="viewparticipants" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h5 style="font-weight: bold" class="modal-title" id="Title_ID">
                </h5>
                <br>


                <div class="row">

                    <div class="col-md-2">

                        <h6 class="text-center"
                            style="color:#e83e8c;font-size: 20px;margin-left:60px;margin-top: 23px"><strong>
                            Creator: </strong></h6>
                    </div>


                    <div class="col-md-8">
                        <h6 id="ID_Creator" class="text-center" style="color:gray;font-size: 20px;margin-left:20px;">
                        </h6>


                    </div>
                    <div class="col-md-2"><!--USER PROFILE IMAGE GOES HERE-->

                        <img class="rounded-circle" width="50" height="50" src="beyonce.jpg"
                             style="margin-left: -130px;border: 1px solid   #DCDCDC ; border-radius: 50px;" alt="">

                    </div><!--end col-->


                </div><!--end row-->


            </div>


            <div class="modal-body">

                <div class="centraliser" style="text-align: center">
                    <h6 style="font-size:15px;"><strong>Forum Participants </strong></h6>
                </div>


                <br>


                <table id="FP_modal">


                </table>

                <div class="modal-footer">

                    <button>Okay</button>


                </div>
            </div>
        </div>
    </div>
</div>


</body>
<!-- Modal for pop up message "User has reported this forum" -->
<div class="modal fade" id="modalReportedForum" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><strong>Forum Left</strong></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                This forum has been reported.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Close
                </button>

            </div>
        </div>
    </div>
</div>

<!-- Modal for pop up message "You can only attach one file" -->
<div class="modal fade" id="modalOneFile" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><strong>Forum Left</strong></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                You can only attach one document to a post.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Close
                </button>

            </div>
        </div>
    </div>
</div>
<!-- Modal for pop up message "User has already reported this forum" -->
<div class="modal fade" id="modalReportedForumAlready" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><strong>Forum Left</strong></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                You have already reported this forum.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="border: 1px solid gray;
            color: #e83e8c; background-color: white;">Close
                </button>

            </div>
        </div>
    </div>
</div>

<!-- Confirm Report Forum Popup -->
<div class="modal fade" id="mi-modal2" role="dialog">
    <div class="modal-dialog">

        <div class="modal-content">
            <div class="modal-body" style="padding:10px;">
                <h4 class="text-center">This forum could be removed from the system. Are you sure you want to report
                    this forum?</h4>
                <br>
                <div class="text-right">
                    <a id="modal-btn-si2" class="btn btn-yes" style=" border: 1px solid gray;
            color: #e83e8c;">
                        Confirm</a>
                    <a class="btn btn-no" id="modal-btn-no2" style=" border: 1px solid gray;
            color: #e83e8c;">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>


    // report account functionality for confirm dialogue using Bootstrap modal
    var modalConfirm = function (callback) {

        $("#reportForumBtn").on("click", function () {
            $("#mi-modal2").modal('show');
        });

        $("#modal-btn-si2").on("click", function () {
            callback(true);
            $("#mi-modal2").modal('hide');
        });

        $("#modal-btn-no2").on("click", function () {
            callback(false);
            $("#mi-modal2").modal('hide');
        });
    };

    // results of the confirmation
    modalConfirm(function (confirm) {
        if (confirm) {                                                                                                              // report forum confirmed

            var reportersRef = firebase.database().ref('Forums').child('{{ forum_id }}').child('Reporters');
            reportersRef.once("value", function (reporters_snapshot) {

                var allReporters = snapshotToArrayKey(reporters_snapshot);                                                          // get list of all people who reported the forum
                if (!arrayContainsValue(allReporters, '{{ this_uid }}')) {                                                      // check if this user had reported the forum before

                    var reporters = {};
                    reporters['{{ this_uid }}'] = '{{ this_uid }}';                                                             // add this user to the list of people who reported the forum
                    firebase.database().ref("Forums").child('{{ forum_id }}').child('Reporters').update(reporters);

                    var numReportsRef = firebase.database().ref("Forums").child('{{ forum_id }}').child('numReported');         // get current num reports
                    numReportsRef.once("value", function (num_reported_snapshot) {                                              //Fetching number of times forum was reported

                        var new_num_reports = num_reported_snapshot.val() + 1;                                                  // increment num reports
                        firebase.database().ref("Forums").child('{{ forum_id }}').update({numReported: new_num_reports});

                        if (new_num_reports > 5) {                                                                              // if the forum has been reported mroe than a certain number of times

                            var wholeForumRef = firebase.database().ref("Forums").child('{{ forum_id }}');                      // get this whole entry
                            wholeForumRef.once("value", function (whole_forum_snapshot) {

                                var wholeForum = whole_forum_snapshot.val();
                                var moveforum = {};
                                moveforum[whole_forum_snapshot.key] = wholeForum;

                                firebase.database().ref("ReportedForums").update(moveforum);                                    // move entry to ForumsReported
                                wholeForumRef.remove();                                                                         // remove this entry

                                document.getElementById('reportForumBtn').style.display = 'none';
                                $("#mi-modal2").modal('hide');
                                $("#modalReportedForum").modal('show');
                            });
                        } else {
                            document.getElementById('reportForumBtn').style.display = 'none';
                            $("#mi-modal2").modal('hide');
                            $("#modalReportedForum").modal('show');
                        }
                    });
                } else {
                    document.getElementById('reportForumBtn').style.display = 'none';                                          // hide report button
                    $("#mi-modal2").modal('hide');                                                                              // close this modal before opening the confirmation modal
                    $("#modalReportedForumAlready").modal('show');
                }
            });
        } else {                                                                                                                  //Do not report forum
            $("#mi-modal2").modal('hide');
        }
    });

    // get a snapshot of a list of keys from firebase and convert it to an array
    function snapshotToArrayKey(snapshot) {
        let returnArr = [];
        snapshot.forEach(childSnapshot => {
            //let item = childSnapshot.val();
            var key = childSnapshot.key;
            returnArr.push(key);
        });
        return returnArr;
    }

    // returns true if the array contains the value
    function arrayContainsValue(array, value) {
        if (array.length > 0) {
            for (let i = 0; i < array.length; i++) {
                if (array[i] == value) {
                    return true;
                }
            }
            return false;
        } else {
            return false;
        }
    }
</script>